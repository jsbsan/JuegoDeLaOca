' Gambas class file

Inherits Regla
'Regla:
'si el jugador cae en la casilla 52, caerá en la cárcel y no podrá tirar el dado en los tres siguientes turnos.

Public Function ejecuta(hjugador As Jugador) As Mensaje'

  Dim tirada As Integer
  Dim mensajeTmp As New Mensaje
  Dim saltoDeOcaAOcaTmp As New SaltoDeOcaAOca

  mensajeTmp.texto = ""
  mensajeTmp.valor = True

  Select Case hjugador.situcasilla
    Case 6
      Print "El jugador " & hjugador.nombre & ", ha caido en la casilla 6, De puente a puente y tiro porque me lleva la corriente, voy a la casilla 12"
      hjugador.situcasilla = 12
      'tiro otra vez
      tirada = dado.tirar()

      Print "Juega el jugador " & hjugador.nombre & ", esta en la casilla: " & hjugador.situcasilla & ", tira el dado y sale: " & tirada
      hjugador.situcasilla += tirada

      Me.ejecuta(hjugador) 'por si cae otra vez en otra oca
    Case 12
      Print "El jugador " & hjugador.nombre & ", ha caido en la casilla 12, De puente a puente y tiro porque me lleva la corriente, voy a la casilla 6"
      hjugador.situcasilla = 6
      'tiro otra vez
      tirada = dado.tirar()

      Print "Juega el jugador " & hjugador.nombre & ", esta en la casilla: " & hjugador.situcasilla & ", tira el dado y sale: " & tirada
      hjugador.situcasilla += tirada

      Me.ejecuta(hjugador) 'por si cae otra vez en otro puente
      saltoDeOcaAOcatmp.ejecuta(HJUGADOR)
  End Select

  Return mensajetmp

End
