' Gambas class file

Inherits Regla

'las posiciones 5, 9, 14, 18, 23, 27, 32, 36, 41, 45, 50, 54 y 59 corresponden a las ocas. Si el jugador cae en ellas se imprimirá el texto »De oca a oca y tiro porque me toca», el jugador avanzará hasta la siguiente casilla de la oca y volverá a tirar. Para programar esto, una buena idea sería tener un HashMap en el que la clave sería la casilla en la que ha caído el jugador y el valor sería la casilla de destino. Luego, llamando al método hashmap.containsKey(posicion) evaluaremos si el jugador ha caído en una casilla con oca, y si es así, recuperaremos la correspondiente casilla de destino.

Public Function ejecuta(hjugador As Jugador) As Mensaje'si es true entonces cayo en oca y tiene que tirar otra vez

  Dim tirada As Integer
  Dim mensajeTmp As New Mensaje
  Dim casillaOca As Integer[]

  mensajeTmp.texto = "salto de oca a oca y tiro porque me toca"
  mensajeTmp.valor = True

  casillaOca = [5, 9, 14, 18, 23, 27, 32, 36, 41, 45, 50, 54, 59]

  If casillaOca.Exist(hjugador.situcasilla) <> False Then
    'esta en la casilla oca
    'comprueba si esta en la ultima
    If hjugador.situcasilla = casillaOca[casillaOca.Count - 1] Then
      'solo tiene que tirar de nuevo
      tirada = dado.tirar()

      Print "Caigo en la casilla " & hjugador.situcasilla & ", " & mensajeTmp.texto
      Print "Juega el jugador " & hjugador.nombre & ", esta en la casilla: " & hjugador.situcasilla & ", tira el dado y sale: " & tirada
      hjugador.situcasilla += tirada
      Me.ejecuta(hjugador) 'por si cae otra vez en otra oca
      Return mensajeTmp
    Else
      'cambio de posicion (de oca en oca)
      Print "Caigo en la casilla " & hjugador.situcasilla & ", " & mensajeTmp.texto

      hjugador.situcasilla = casillaoca[casillaoca.Find(hjugador.situcasilla) + 1] 'avanzo hasta la siguiente casilla oca

      tirada = dado.tirar()

      Print "Juega el jugador " & hjugador.nombre & ", esta en la casilla: " & hjugador.situcasilla & ", tira el dado y sale: " & tirada
      hjugador.situcasilla += tirada

      Me.ejecuta(hjugador) 'por si cae otra vez en otra oca

      Return mensajeTmp
    Endif

  Endif

  mensajeTmp.texto = ""
  mensajeTmp.valor = False 'no hay salto ni tiro de nuevo

  Return mensajeTmp

End
